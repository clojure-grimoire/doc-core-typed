{:type :fn, :src "(deftest hmap-cast-test\n  (is (both-subtype?\n        (ety\n          (fn\n            [m :- (HMap)]\n            (assert (:foo m))\n            m))\n        (parse-clj `['{} :-> '{:foo Any}\n                     :filters {:then ~'tt\n                               :else ~'ff}\n                     :object {:id 0}])))\n  (is (both-subtype? \n        (ety\n          (fn\n            [m :- (HMap)]\n            :- (HMap :mandatory {:foo (clojure.core.typed/Vec clojure.core.typed/Any)})\n            (assert (vector? (:foo m)))\n            m))\n        (parse-clj `[(HMap) :-> \n                     (HMap :mandatory {:foo (Vec Any)})\n                     :filters {:then ~'tt\n                               :else ~'ff}\n                     :object {:id 0}])))\n  (is (both-subtype? \n        (ety \n          (fn\n            [m :- (HMap :mandatory {:bar Any})]\n            (assert (nil? (:foo m)))\n            m))\n        (parse-clj `[(HMap :mandatory {:bar Any}) :-> \n                     (HMap :mandatory {:bar Any}\n                           :optional {:foo nil})\n                     :filters {:then ~'tt\n                               :else ~'ff}\n                     :object {:id 0}])))\n  (is\n    (both-subtype?\n      (ety\n        (fn\n          [m :- '{}]\n          (assert (not (vector? (:foo m))))\n          m))\n      (parse-clj `[(HMap) :-> \n                   ; not sure if this should simplify to (HMap)\n                   (HMap :optional {:foo Any})\n                   :filters {:then ~'tt\n                             :else ~'ff}\n                   :object {:id 0}])))\n  (is \n    (clj\n      (let [t1 (clj (update (parse-type `(HMap))\n                            (parse-filter `(~'is (Vec Any) ~'m [(~'Key :foo)]))))\n            t2 (clj (parse-type `(HMap :mandatory {:foo (Vec Any)})))]\n        (both-subtype? t1 t2)))))", :ns "clojure.core.typed.test.core", :name "hmap-cast-test", :file "clojure/core/typed/test/core.clj", :column 1, :line 1996, :test #<core$fn__28439 clojure.core.typed.test.core$fn__28439@5ca4910d>}